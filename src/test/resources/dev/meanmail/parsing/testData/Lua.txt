Nginx configuration file(0,1012)
  DirectiveStmtImpl(DIRECTIVE_STMT)(0,1012)
    NameStmtImpl(NAME_STMT)(0,6)
      PsiElement(NginxTokenType.IDENTIFIER)('server')(0,6)
    PsiWhiteSpace(' ')(6,7)
    BlockStmtImpl(BLOCK_STMT)(7,1012)
      PsiElement(NginxTokenType.LBRACE)('{')(7,8)
      PsiWhiteSpace('\n    ')(8,13)
      DirectiveStmtImpl(DIRECTIVE_STMT)(13,34)
        NameStmtImpl(NAME_STMT)(13,19)
          PsiElement(NginxTokenType.IDENTIFIER)('listen')(13,19)
        PsiWhiteSpace(' ')(19,20)
        ValueStmtImpl(VALUE_STMT)(20,23)
          PsiElement(NginxTokenType.VALUE)('443')(20,23)
        PsiWhiteSpace(' ')(23,24)
        ValueStmtImpl(VALUE_STMT)(24,27)
          PsiElement(NginxTokenType.IDENTIFIER)('ssl')(24,27)
        PsiWhiteSpace(' ')(27,28)
        ValueStmtImpl(VALUE_STMT)(28,33)
          PsiElement(NginxTokenType.IDENTIFIER)('http2')(28,33)
        PsiElement(NginxTokenType.SEMICOLON)(';')(33,34)
      PsiWhiteSpace('\n    ')(34,39)
      DirectiveStmtImpl(DIRECTIVE_STMT)(39,65)
        NameStmtImpl(NAME_STMT)(39,45)
          PsiElement(NginxTokenType.IDENTIFIER)('listen')(39,45)
        PsiWhiteSpace(' ')(45,46)
        ValueStmtImpl(VALUE_STMT)(46,54)
          PsiElement(NginxTokenType.VALUE)('[::]:443')(46,54)
        PsiWhiteSpace(' ')(54,55)
        ValueStmtImpl(VALUE_STMT)(55,58)
          PsiElement(NginxTokenType.IDENTIFIER)('ssl')(55,58)
        PsiWhiteSpace(' ')(58,59)
        ValueStmtImpl(VALUE_STMT)(59,64)
          PsiElement(NginxTokenType.IDENTIFIER)('http2')(59,64)
        PsiElement(NginxTokenType.SEMICOLON)(';')(64,65)
      PsiWhiteSpace('\n    ')(65,70)
      DirectiveStmtImpl(DIRECTIVE_STMT)(70,84)
        NameStmtImpl(NAME_STMT)(70,81)
          PsiElement(NginxTokenType.IDENTIFIER)('server_name')(70,81)
        PsiWhiteSpace(' ')(81,82)
        ValueStmtImpl(VALUE_STMT)(82,83)
          PsiElement(NginxTokenType.IDENTIFIER)('_')(82,83)
        PsiElement(NginxTokenType.SEMICOLON)(';')(83,84)
      PsiWhiteSpace('\n\n    ')(84,90)
      DirectiveStmtImpl(DIRECTIVE_STMT)(90,111)
        NameStmtImpl(NAME_STMT)(90,93)
          PsiElement(NginxTokenType.IDENTIFIER)('set')(90,93)
        PsiWhiteSpace(' ')(93,94)
        ValueStmtImpl(VALUE_STMT)(94,107)
          PsiElement(NginxTokenType.VALUE)('$my_nginx_var')(94,107)
        PsiWhiteSpace(' ')(107,108)
        ValueStmtImpl(VALUE_STMT)(108,110)
          StringStmtImpl(STRING_STMT)(108,110)
            PsiElement(NginxTokenType.DQUOTE)('"')(108,109)
            PsiElement(NginxTokenType.DQUOTE)('"')(109,110)
        PsiElement(NginxTokenType.SEMICOLON)(';')(110,111)
      PsiWhiteSpace('\n\n    ')(111,117)
      DirectiveStmtImpl(DIRECTIVE_STMT)(117,749)
        NameStmtImpl(NAME_STMT)(117,125)
          PsiElement(NginxTokenType.IDENTIFIER)('location')(117,125)
        PsiWhiteSpace(' ')(125,126)
        ValueStmtImpl(VALUE_STMT)(126,127)
          PsiElement(NginxTokenType.VALUE)('/')(126,127)
        PsiWhiteSpace(' ')(127,128)
        BlockStmtImpl(BLOCK_STMT)(128,749)
          PsiElement(NginxTokenType.LBRACE)('{')(128,129)
          PsiWhiteSpace('\n        ')(129,138)
          AccessByLuaBlockStmtImpl(ACCESS_BY_LUA_BLOCK_STMT)(138,743)
            PsiElement(NginxTokenType.ACCESS_BY_LUA_BLOCK)('access_by_lua_block')(138,157)
            PsiWhiteSpace(' ')(157,158)
            LuaBlockStmtImpl(LUA_BLOCK_STMT)(158,743)
              PsiElement(NginxTokenType.LBRACE)('{')(158,159)
              LuaStmtImpl(LUA_STMT)(159,742)
                PsiElement(NginxTokenType.LUA)('\n            local redis = require "resty.redis"\n            local red = redis:new()\n            red:set_timeout(200)\n            local ok, err = red:connect("127.0.0.1", 6379)\n            if not ok then\n                return\n            end\n\n            local access_num, err = red:incr("access_" .. ngx.var.remote_addr)\n\n            if (not access_num or access_num >= 10) then\n                ngx.var.my_nginx_var = "deny"\n                return\n            end\n            ngx.var.my_nginx_var = "allow"\n            red:expire("access_" .. ngx.var.remote_addr, 16*3600)\n        ')(159,742)
              PsiElement(NginxTokenType.RBRACE)('}')(742,743)
          PsiWhiteSpace('\n    ')(743,748)
          PsiElement(NginxTokenType.RBRACE)('}')(748,749)
      PsiWhiteSpace('\n\n    ')(749,755)
      SslCertificateByLuaBlockStmtImpl(SSL_CERTIFICATE_BY_LUA_BLOCK_STMT)(755,944)
        PsiElement(NginxTokenType.SSL_CERTIFICATE_BY_LUA_BLOCK)('ssl_certificate_by_lua_block')(755,783)
        PsiWhiteSpace(' ')(783,784)
        LuaBlockStmtImpl(LUA_BLOCK_STMT)(784,944)
          PsiElement(NginxTokenType.LBRACE)('{')(784,785)
          LuaStmtImpl(LUA_STMT)(785,943)
            PsiElement(NginxTokenType.LUA)('\n        if ngx.var.my_nginx_var == "deny" then\n            ngx.log(ngx.ERR, "access denied")\n            return ngx.exit(ngx.HTTP_FORBIDDEN)\n        end\n    ')(785,943)
          PsiElement(NginxTokenType.RBRACE)('}')(943,944)
      PsiWhiteSpace('\n\n    ')(944,950)
      SetByLuaBlockStmtImpl(SET_BY_LUA_BLOCK_STMT)(950,1010)
        PsiElement(NginxTokenType.SET_BY_LUA_BLOCK)('set_by_lua_block')(950,966)
        PsiWhiteSpace(' ')(966,967)
        LuaBlockStmtImpl(LUA_BLOCK_STMT)(967,1010)
          PsiElement(NginxTokenType.LBRACE)('{')(967,968)
          LuaStmtImpl(LUA_STMT)(968,1009)
            PsiElement(NginxTokenType.LUA)('\n        return ngx.var.my_nginx_var\n    ')(968,1009)
          PsiElement(NginxTokenType.RBRACE)('}')(1009,1010)
      PsiWhiteSpace('\n')(1010,1011)
      PsiElement(NginxTokenType.RBRACE)('}')(1011,1012)
